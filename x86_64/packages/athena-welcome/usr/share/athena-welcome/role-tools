#!/bin/bash

echo -n "H4sIAAAAAAAAA7XSTQ6DIBAF4D2nmE0bQxq4Avc/VQMiDD+Db2hlgQr4PgYl2mnhaltvk/lB3Je16kCmZh9V52Zs/jlVRpXnrFGXqIpVqDeohsXVW1TBwiqA4iyqQijMgiqIoiymwijIQqqU/qj6mibn2y0WUYVINmrZEvcfVayhLxEv1pSApVqf3rOPGfhiMehTJs2wa+py+qSVmabrvZXWnqob5tq4EA7R7c9lBD3753KtnUTnxfKhsQhqQ0ppdY5vjX0Uf14Mmz765Y2KtyGmZOXReMIp2Ka+rldTiw2UnlzszRejmEcVIQoAAA==" | base64 -d | gunzip
echo

if [ -z "$1" ]
  then
    echo "No role ID supplied. Exiting..."
    exit 1
fi

role=$1
gitweb=0

declare -A gitsource=(["https://github.com/danielmiessler/SecLists"]="/usr/share/payloads/SecLists" ["https://github.com/DragonJAR/Security-Wordlist"]="/usr/share/payloads/Security-Wordlist")

#echo $role
if [ $role = "BH" ]; then
   hacktools="athena-blackhat"
   gitweb=1
elif [ $role = "BBH" ]; then   
   hacktools="athena-bountyhunter"
   gitweb=1
elif [ $role = "CR" ]; then
   hacktools="athena-cracker"
   gitweb=1
elif [ $role = "ES" ]; then
   hacktools="athena-student"
   gitweb=1
elif [ $role = "FA" ]; then
   hacktools="athena-forensic"
elif [ $role = "MA" ]; then
   hacktools="athena-malware"
elif [ $role = "MO" ]; then
   hacktools="athena-mobile"
elif [ $role = "NA" ]; then
   hacktools="athena-network"
elif [ $role = "OS" ]; then
   hacktools="athena-osint"
elif [ $role = "RT" ]; then
   hacktools="athena-redteamer"
   gitweb=1
elif [ $role = "WP" ]; then
   hacktools="athena-webpentester"
   gitweb=1
else
   echo "No valid role."
   exit 1
fi

index=0

################################################
#              UNINSTALLING TOOLS              #
################################################
printf 'Do you want to remove tools of your previous roles (y/n)? '
read answer
if [ "$answer" != "${answer#[Yy]}" ] ;then # this grammar (the #[] operator) means that the variable $answer where any Y or y in 1st position will be dropped if they exist.
   echo
   echo "Uninstalling any previous role tools..."
   echo

   sudo pacman -Rs --noconfirm athena-blackhat athena-bountyhunter athena-cracker athena-student athena-forensic athena-malware athena-mobile athena-network athena-osint athena-redteamer athena-webpentester
fi

################################################
#            INSTALLING ROLE TOOLS             #
################################################

echo
echo "Installing tools..."
echo

sudo pacman -S --noconfirm $hacktools

if [ $gitweb ]; then
   echo
   echo "Retrieving payload repositories..."
   echo
   
   sudo pacman -S --noconfirm athena-payloadsallthethings athena-fuzzdb athena-auto-wordlists

   for i in "${!gitsource[@]}"
   do
      echo "Retrieving $i..."
      sudo git clone $i ${gitsource[$i]}
      echo
   done
   
   if [ ! -f /usr/share/payloads/SecLists/Passwords/Leaked-Databases/rockyou.txt ]
   then
       echo "Extracting rockyou.txt..."
       sudo tar -zxvf /usr/share/payloads/SecLists/Passwords/Leaked-Databases/rockyou.txt.tar.gz -C /usr/share/payloads/SecLists/Passwords/Leaked-Databases
   else
       echo "rockyou.txt found!"
   fi
   
   echo "Removing useless comments from directory list files..."
   sudo sed -i 's/^\#.*$//g' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt && sudo sed -i '/^$/d' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt
   sudo sed -i 's/^\#.*$//g' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt && sudo sed -i '/^$/d' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
   sudo sed -i 's/^\#.*$//g' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt && sudo sed -i '/^$/d' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt
fi

echo "All done. Your role has been set!"
read -p "Press enter to continue"
