#!/bin/bash

echo -n "H4sIAAAAAAAAA7XSTQ6DIBAF4D2nmE0bQxq4Avc/VQMiDD+Db2hlgQr4PgYl2mnhaltvk/lB3Je16kCmZh9V52Zs/jlVRpXnrFGXqIpVqDeohsXVW1TBwiqA4iyqQijMgiqIoiymwijIQqqU/qj6mibn2y0WUYVINmrZEvcfVayhLxEv1pSApVqf3rOPGfhiMehTJs2wa+py+qSVmabrvZXWnqob5tq4EA7R7c9lBD3753KtnUTnxfKhsQhqQ0ppdY5vjX0Uf14Mmz765Y2KtyGmZOXReMIp2Ka+rldTiw2UnlzszRejmEcVIQoAAA==" | base64 -d | gunzip
echo

if [ -z "$1" ]
  then
    echo "No role supplied. Exiting..."
    exit 1
fi

role=$1
gitweb=0

################################################
#                  ROLE TOOLS                  #
################################################

declare -a blackhattools=("blackarch" "ratinject" "ians")

declare -a bbhtools=("nmap" "sublist3r" "amass" "massdns" "findomain" "theharvester" "chaos-client" "domained" "shuffledns" "altdns" "dns-parallel-prober" "dnscan" "knock" "hakrevdns" "dnsx" "subfinder" "assetfinder" "vhostscan" "masscan" "rustscan" "naabu" "sandmap" "eyewitness" "eyeballer" "scrying" "depix" "httpscreenshot" "aquatone" "gowitness" "webanalyze" "whatweb" "httpx" "feroxbuster" "dirsearch" "filebuster" "dirstalk" "dirbuster-ng" "gospider" "hakrawler" "linkfinder" "waybackurls" "gau" "parameth" "parampampam" "arjun" "commix" "corsy" "corstest" "crlfuzz" "injectus" "xsrfprobe" "dotdotpwn" "fdsploit" "liffy" "lfisuite" "graphqlmap" "ysoserial" "phpggc" "smuggler" "h2csmuggler" "ssrfmap" "gopherus" "ssrf-sheriff" "extended-ssrf-search" "lorsrf" "rbndr" "nosqli" "xsstrike" "xsscrapy" "dalfox" "xsser" "xspear" "docem" "brutexss" "xsscon" "xxeserv" "xxexploiter" "xxeinjector" "changeme" "brutex" "patator" "gitleaks" "trufflehog" "gitgraber" "gitrob" "gitminer" "shhgit" "detect-secrets" "whispers" "gittools" "git-dumper" "dvcs-ripper" "s3scanner" "awsbucketdump" "cmsmap" "joomscan" "pyfiscan" "jwt-hack" "jwt-cracker" "wafw00f" "nikto" "wpscan" "burpsuite" "dirb" "ffuf" "wfuzz" "sqlmap" "nosqlmap" "sleuthql" "subjack" "subover" "second-order" "takeover" "nuclei" "sn1per" "arachni" "jaeles" "getsploit" "findsploit" "jsonbee" "hydra" "cewl" "crunch" "exploitdb" "metasploit" "gobuster" "commentor" "osert" "wordlister" "pwncat-caleb")

declare -a malwareanalysttools=("blackarch-binary" "blackarch-debugger" "blackarch-decompiler" "blackarch-disassembler" "blackarch-malware" "blackarch-reversing" "nasm")

declare -a crackertools=("blackarch-cracker" "blackarch-crypto")

declare -a forensictools=("blackarch-forensic")

declare -a mobiletools=("blackarch-mobile" "blackarch-reversing")

declare -a networktools=("blackarch-ids" "blackarch-networking" "blackarch-proxy" "blackarch-radio" "blackarch-sniffer" "blackarch-spoof" "blackarch-tunnel" "blackarch-wireless")

declare -a osint=("athena-osint")

declare -a redtools=("blackarch-cracker" "blackarch-database" "blackarch-debugger" "blackarch-decompiler" "blackarch-exploitation" "blackarch-fuzzer" "blackarch-networking" "blackarch-recon" "blackarch-scanner" "blackarch-sniffer" "blackarch-spoof" "blackarch-webapp" "blackarch-windows" "ratinject" "ians")

declare -a studenttools=("legion" "dmitry" "nmap" "spiderfoot" "theharvester" "enum4linux" "wafw00f" "fierce" "nikto" "unix-privesc-check" "wpscan" "burpsuite" "dirb" "dirbuster" "ffuf" "wfuzz" "sqlmap" "john" "hashcat" "hydra" "cewl" "crunch" "rsmangler" "medusa" "mitmproxy" "responder" "wireshark-qt" "kismet" "reaver" "wifite" "fern-wifi-cracker" "aircrack-ng" "spooftooph" "nasm" "radare2" "ghidra" "edb" "exploitdb" "metasploit" "set" "powersploit" "mimikatz" "evil-winrm" "proxychains-ng" "weevely" "gobuster" "hashid" "commentor" "osert" "wordlister" "binwalk" "pwncat-caleb")

declare -a webtools=("blackarch-webapp" "blackarch-fuzzer")

################################################
#            GIT PAYLOAD REPOSITORIES          #
################################################

declare -a gitsource=("https://github.com/carlospolop/Auto_Wordlists" "https://github.com/fuzzdb-project/fuzzdb" "https://github.com/swisskyrepo/PayloadsAllTheThings" "https://github.com/danielmiessler/SecLists" "https://github.com/DragonJAR/Security-Wordlist")
declare -a gitfolderdest=("/usr/share/payloads/Auto_Wordlists" "/usr/share/payloads/FuzzDB" "/usr/share/payloads/PayloadsAllTheThings" "/usr/share/payloads/SecLists" "/usr/share/payloads/Security-Wordlist")

#echo $role

if [ $role = "BBH" ]; then   
   hacktools=("${bbhtools[@]}")
   gitweb=1
elif [ $role = "BH" ]; then
   hacktools=("${blackhattools[@]}")
   gitweb=1
elif [ $role = "CR" ]; then
   hacktools=("${crackertools[@]}")
   gitweb=1
elif [ $role = "ES" ]; then
   hacktools=("${studenttools[@]}")
   gitweb=1
elif [ $role = "FA" ]; then
   hacktools=("${forensictools[@]}")
elif [ $role = "MA" ]; then
   hacktools=("${malwareanalysttools[@]}")
elif [ $role = "MO" ]; then
   hacktools=("${mobiletools[@]}")
elif [ $role = "NA" ]; then
   hacktools=("${networktools[@]}")
elif [ $role = "OS" ]; then
   hacktools=("${osint[@]}")
elif [ $role = "RT" ]; then
   hacktools=("${redtools[@]}")
   gitweb=1
elif [ $role = "WP" ]; then
   hacktools=("${webtools[@]}")
   gitweb=1
else
   echo "No valid role."
   exit 1
fi

index=0

################################################
#              UNINSTALLING TOOLS              #
################################################
printf 'Do you want to remove tools of your previous roles (y/n)? '
read answer
if [ "$answer" != "${answer#[Yy]}" ] ;then # this grammar (the #[] operator) means that the variable $answer where any Y or y in 1st position will be dropped if they exist.
   echo
   echo "Uninstalling any previous role tools..."
   echo

   sudo pacman -Syy

   for i in "${studenttools[@]}"
   do 
      if pacman -Qq $i > /dev/null 2>&1; then
         sudo pacman -R --noconfirm $i
      fi
   done

   for i in "${bbhtools[@]}"
   do 
      if pacman -Qq $i > /dev/null 2>&1; then
         sudo pacman -R --noconfirm $i
      fi
   done

   for i in "${malwareanalysttools[@]}"
   do 
      if pacman -Qq $i > /dev/null 2>&1; then
         sudo pacman -R --noconfirm $i
      fi
   done

   for i in "${crackertools[@]}"
   do 
      if pacman -Qq $i > /dev/null 2>&1; then
         sudo pacman -R --noconfirm $i
      fi
   done

   for i in "${forensictools[@]}"
   do 
      if pacman -Qq $i > /dev/null 2>&1; then
         sudo pacman -R --noconfirm $i
      fi
   done

   for i in "${mobiletools[@]}"
   do 
      if pacman -Qq $i > /dev/null 2>&1; then
         sudo pacman -R --noconfirm $i
      fi
   done

   for i in "${networktools[@]}"
   do 
      if pacman -Qq $i > /dev/null 2>&1; then
         sudo pacman -R --noconfirm $i
      fi
   done

   for i in "${osint[@]}"
   do 
      if pacman -Qq $i > /dev/null 2>&1; then
         sudo pacman -R --noconfirm $i
      fi
   done

   for i in "${redtools[@]}"
   do 
      if pacman -Qq $i > /dev/null 2>&1; then
         sudo pacman -R --noconfirm $i
      fi
   done

   for i in "${webtools[@]}"
   do 
      if pacman -Qq $i > /dev/null 2>&1; then
         sudo pacman -R --noconfirm $i
      fi
   done
fi
################################################
#            INSTALLING ROLE TOOLS             #
################################################

echo
echo "Installing tools..."
echo

for i in "${hacktools[@]}"
do 
   if ! pacman -Qq $i > /dev/null 2>&1; then
      sudo pacman -S --noconfirm $i
   fi
done

if [ $gitweb ]; then
   echo
   echo "Retrieving payload repositories..."
   echo
   
   for i in "${gitsource[@]}"
   do
      echo "Retrieving $i..."
      sudo git clone $i ${gitfolderdest[$index]}
      index=$(expr $index + 1)
      echo
   done
   
   if [ ! -f /usr/share/payloads/SecLists/Passwords/Leaked-Databases/rockyou.txt ]
   then
       echo "Extracting rockyou.txt..."
       sudo tar -zxvf /usr/share/payloads/SecLists/Passwords/Leaked-Databases/rockyou.txt.tar.gz -C /usr/share/payloads/SecLists/Passwords/Leaked-Databases
   else
       echo "rockyou.txt found!"
   fi
   
   sudo sed -i 's/^\#.*$//g' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt && sudo sed -i '/^$/d' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt
   sudo sed -i 's/^\#.*$//g' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt && sudo sed -i '/^$/d' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
   sudo sed -i 's/^\#.*$//g' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt && sudo sed -i '/^$/d' /usr/share/payloads/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt
fi

echo "All done. Your role has been set!"
read -p "Press enter to continue"
